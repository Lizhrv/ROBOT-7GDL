<!DOCTYPE html>
<html>
<head>
<title>Control de Yarbito</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; background-color: #f4f4f9; }
  h1 { color: #333; }
  .controls { margin: 20px 0; }
  button {
    padding: 15px 30px;
    margin: 10px;
    font-size: 18px;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    transition: background-color 0.3s;
  }
  #btnStart { background-color: #4CAF50; color: white; }
  #btnStart:hover { background-color: #45a049; }
  #btnRutina2 { background-color: #008CBA; color: white; }
  #btnRutina2:hover { background-color: #007bb5; }
  #btnReset { background-color: #f44336; color: white; }
  #btnReset:hover { background-color: #da190b; }
  #statusText {
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
    color: #555;
  }
</style>
</head>
<body>

<h1> Control de Yarbito</h1>

<div class="controls">
  <button id="btnStart" onclick="startRoutine()"> INICIAR RUTINA 1</button>
  
  <button id="btnRutina2" onclick="startRoutine2()"> INICIAR RUTINA 2</button>

  <button id="btnReset" onclick="resetRoutine()"> RESET / REPOSO</button>
  
</div>

<p id="statusText">Estado del robot: Listo para iniciar.</p>

<script>
    // Reemplaza esta IP con la direcci贸n IP que te da el Monitor Serial del Arduino.
    const ARDUINO_IP = '172.20.10.2'; 

    // Funci贸n auxiliar para actualizar el texto de estado en la p谩gina
    function updateStatus(text, success) {
        const statusElement = document.getElementById('statusText');
        statusElement.innerText = 'Estado de Yarbito: ' + text;
        statusElement.style.color = success ? '#333' : '#f44336';
    }

    // Funci贸n gen茅rica para enviar comandos al Arduino
    // La parte del error de conexi贸n (catch) ha sido modificada para NO usar alert.
    function sendCommand(command, successMessage, failureMessage) {
        updateStatus('Enviando comando ' + command + '...', true);
        
        // Construye la URL completa
        const url = 'http://' + ARDUINO_IP + command;

        fetch(url) 
            .then(response => {
                if (response.ok) {
                    // Comando exitoso (c贸digo 200)
                    updateStatus(successMessage, true);
                } else {
                    // El Arduino respondi贸, pero con un error (ej. c贸digo 404)
                    updateStatus(failureMessage + ' (C贸digo: ' + response.status + ')', false);
                }
            })
            .catch(error => {
                // Fallo total de conexi贸n (IP incorrecta o Arduino desconectado)
                // Se elimina la ventana emergente (alert)
                updateStatus('ERROR: No se pudo conectar a la IP. Verifique la red.', false);
                console.error('Error de conexi贸n:', error); // Muestra el error en la consola del navegador
            });
    }

    // Rutina 1: El comando original de iniciar la rutina de Recoger/Soltar
    function startRoutine() {
        sendCommand('/start', 'Rutina 1 (Recoger/Soltar) activada.', 'Error al activar Rutina 1.');
    }

    // Rutina 2: Nuevo comando para la segunda rutina que debes agregar al Arduino
    function startRoutine2() {
        sendCommand('/rutina2', 'Rutina 2 (Movimiento Alterno) activada.', 'Error al activar Rutina 2.');
    }

    // Comando RESET: Pone al robot en la posici贸n de reposo
    function resetRoutine() {
        sendCommand('/reset', 'Yarbito restablecido y en reposo.', 'Error al ejecutar RESET.');
    }
</script>

</body>
</html>